<!-- productos.component.html -->
<main class="page">
  <app-navbar></app-navbar>

  <!-- HERO -->
  <section class="hero">
    <div class="hero__overlay"></div>

    <div class="container hero__content">
      <p class="hero__kicker">Productos</p>
      <h1 class="hero__title">
        Telas metálicas <span>de calidad</span>
      </h1>
      <p class="hero__subtitle">
        {{ productoActual().nombre }} — <strong>{{ productoActual().subtitulo }}</strong>
      </p>

      <div class="hero__cta">
        <button class="btn btn--primary" (click)="setTab('especificaciones')">Ver especificaciones</button>
        <button class="btn btn--ghost" (click)="setTab('descripcion')">Descripción</button>
      </div>
    </div>
  </section>

  <!-- BENEFICIOS -->
  <section class="strip">
    <div class="container strip__grid">
      <div class="strip__item">
        <img class="icon" src="../../assets/icon/ajustes.png" />
        <div class="strip__title">Fabricación a medida</div>
        <div class="strip__text">Te ayudamos a elegir malla + Ø de alambre según tu necesidad.</div>
      </div>

      <div class="strip__item">
        <img class="icon" src="../../assets/icon/fabrica.png" />
        <div class="strip__title">Uso industrial</div>
        <div class="strip__text">Filtrado, tamizado, zarandeo, protección y contención.</div>
      </div>

      <div class="strip__item">
        <img class="icon" src="../../assets/icon/viga-de-acero.png" />
        <div class="strip__title">Acero inoxidable</div>
        <div class="strip__text">Opciones AISI 304 / 316 con anchos estándar disponibles.</div>
      </div>
    </div>
  </section>

  <!-- PRODUCT PICKER -->
  <section class="picker-section">
    <div class="container">
      <div class="picker-grid">
        <button
          class="product-card"
          *ngFor="let p of productos"
          type="button"
          [class.is-active]="selectedProductoKey() === p.key"
          (click)="selectProducto(p.key)"
        >
          <div class="product-card__media">
            <img class="product-card__img" [src]="p.img" [alt]="p.title" loading="lazy" />
          </div>
          <div class="product-card__text">
            <div class="product-card__title">{{ p.title }}</div>
            <div class="product-card__sub">{{ p.subtitle }}</div>
          </div>
        </button>
      </div>
    </div>
  </section>

  <!-- CONTENIDO PRINCIPAL -->
  <section class="section">
    <div class="container grid">
      <!-- CARD PRINCIPAL -->
      <article class="card">
        <header class="card__header">
          <div>
            <h2 class="card__title">{{ productoActual().nombre }}</h2>
            <p class="card__subtitle">{{ productoActual().subtitulo }}</p>
          </div>

          <div class="badges">
            <span class="badge" *ngFor="let m of productoActual().materiales">{{ m }}</span>
          </div>
        </header>

        <!-- TABS -->
        <nav class="tabs" role="tablist" aria-label="Secciones del producto">
          <button class="tab" [class.is-active]="activeTab() === 'descripcion'" (click)="setTab('descripcion')">
            Descripción
          </button>
          <button class="tab" [class.is-active]="activeTab() === 'especificaciones'" (click)="setTab('especificaciones')">
            Especificaciones
          </button>
          <button class="tab" [class.is-active]="activeTab() === 'usos'" (click)="setTab('usos')">
            Usos comunes
          </button>
        </nav>

        <!-- TAB: DESCRIPCIÓN -->
        <section class="card__body" *ngIf="activeTab() === 'descripcion'">
          <p class="lead">
            {{ productoActual().descripcion }}
          </p>

          <div class="info-grid">
            <div class="info">
              <div class="info__label">Anchos disponibles</div>
              <div class="info__value">
                <span class="pill" *ngFor="let a of productoActual().anchosDisponiblesMm">{{ a }} mm</span>
              </div>
            </div>

            <div class="info">
              <div class="info__label">Cómo pedir presupuesto</div>
              <div class="info__value">
                Indicá <strong>número de malla</strong>, <strong>Ø de alambre</strong>, <strong>ancho</strong> y material (304/316).
              </div>
            </div>
          </div>

          <div class="callout">
            <div>
              <div class="callout__title">Tip rápido</div>
              <div class="callout__text">
                Usá el buscador de la tabla para encontrar tu malla y copiar los valores de Ø, luz y área abierta.
              </div>
            </div>
            <button class="btn btn--primary" (click)="setTab('especificaciones')">Ir a la tabla</button>
          </div>
        </section>

        <!-- TAB: ESPECIFICACIONES -->
        <section class="card__body" *ngIf="activeTab() === 'especificaciones'">

          <!-- Tabla telas metálicas inox -->
          <ng-container *ngIf="selectedProductoKey() === 'telas'">
            <div class="filters">
              <div class="field">
                <label class="label">Subcategoría</label>
                <div class="segmented">
                  <button class="seg" [class.is-active]="filtroTipo() === 'Todos'" (click)="setTipo('Todos')">Todas</button>
                  <button class="seg" [class.is-active]="filtroTipo() === 'AISI 304'" (click)="setTipo('AISI 304')">AISI 304</button>
                  <button class="seg" [class.is-active]="filtroTipo() === 'AISI 316 / 316L'" (click)="setTipo('AISI 316 / 316L')">AISI 316 / 316L</button>
                  <button class="seg" [class.is-active]="filtroTipo() === 'Reps'" (click)="setTipo('Reps')">Reps</button>
                  <button class="seg" [class.is-active]="filtroTipo() === 'Acero negro'" (click)="setTipo('Acero negro')">Acero negro</button>
                  <button class="seg" [class.is-active]="filtroTipo() === 'Especiales 304'" (click)="setTipo('Especiales 304')">Especiales 304</button>
                </div>
              </div>

              <div class="field">
                <label class="label">Buscar</label>
                <input
                  class="input"
                  type="text"
                  placeholder="Ej: 14, 0.60, 12/90, 270..."
                  [value]="filtroTexto()"
                  (input)="onBuscar(($any($event.target).value))"
                />
                <div class="hint">
                  Mostrando <strong>{{ filteredSpecs().length }}</strong> de <strong>{{ totalSpecs() }}</strong>.
                </div>
              </div>
            </div>

            <div class="table-wrap" role="region" aria-label="Tabla de especificaciones" tabindex="0">
              <table class="table">
                <thead>
                  <tr>
                    <th>Subcategoría</th>
                    <th>Malla</th>
                    <th>Ø alambre (mm)</th>
                    <th>Luz (mm)</th>
                    <th>Área abierta (%)</th>
                    <th>Filtrado abs. (μm)</th>
                    <th>Filtrado nom. (μm)</th>
                    <th>Peso (kg/m²)</th>
                  </tr>
                </thead>

                <tbody>
                  <tr *ngFor="let r of filteredSpecs()">
                    <td>
                      <span class="chip"
                        [class.is-316]="r.tipo === 'AISI 316 / 316L'"
                        [class.is-reps]="r.tipo === 'Reps'"
                        [class.is-negro]="r.tipo === 'Acero negro'"
                        [class.is-especial]="r.tipo === 'Especiales 304'">
                        {{ r.tipo }}
                      </span>
                    </td>
                    <td class="mono">{{ r.malla }}</td>
                    <td class="mono">{{ r.diametroMm }}</td>
                    <td class="mono">{{ r.luzMm || '—' }}</td>
                    <td class="mono">{{ r.areaAbiertaPct || '—' }}</td>
                    <td class="mono">{{ r.filtradoAbsolutouM || '—' }}</td>
                    <td class="mono">{{ r.filtradoNominaluM || '—' }}</td>
                    <td class="mono">{{ r.pesoKgM2 || '—' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="note">
              * Reps y Acero negro expresan filtrado absoluto/nominal en μm en lugar de luz de malla estándar.
            </div>
          </ng-container>

          <!-- Tabla tejido artístico -->
          <ng-container *ngIf="selectedProductoKey() === 'artistico'">
            <app-tejido-artistico></app-tejido-artistico>
          </ng-container>

          <!-- Especificaciones packos filtrantes -->
          <ng-container *ngIf="selectedProductoKey() === 'packs'">
            <p class="lead">Ofrecemos tanto soluciones estándar como configuraciones personalizadas, adaptadas a los requerimientos específicos de cada proceso industrial. Dos opciones de ensamblaje disponibles: con aro de aluminio o mediante soldadura por punto.</p>

            <div class="ventajas-grid">
              <div class="ventaja-card">
                <div class="ventaja-card__title">Disponibilidad inmediata</div>
                <div class="ventaja-card__text">Amplio stock de matrices para cortes de distintos diámetros, minimizando tiempos de espera y paradas de producción.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Resistencia superior</div>
                <div class="ventaja-card__text">Materiales seleccionados específicamente para soportar condiciones extremas de presión, temperatura y desgaste en procesos continuos.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Precisión garantizada</div>
                <div class="ventaja-card__text">Fabricación de alta precisión que asegura filtración óptima y consistente, mejorando la calidad del producto final.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Respaldo técnico experto</div>
                <div class="ventaja-card__text">Soporte técnico con conocimiento profundo del rubro y soluciones efectivas adaptadas a tus necesidades.</div>
              </div>
            </div>

            <div class="callout" style="margin-top: 18px;">
              <div>
                <div class="callout__title">¿Necesitás un packo a medida?</div>
                <div class="callout__text">Indicanos diámetro, número de capas, material y tipo de ensamblaje (aro de aluminio o soldadura por punto).</div>
              </div>
              <button class="btn btn--primary" routerLink="/contacto">Consultar</button>
            </div>
          </ng-container>

          <!-- Especificaciones zarandas clasificatorias -->
          <ng-container *ngIf="selectedProductoKey() === 'zarandas'">
            <p class="lead">Fabricadas con alambre de aleación de acero que resiste la abrasión y el desgaste prematuro. Se proveen a medida en largo y ancho, con o sin borde de sujeción, recubierto o no de chapa.</p>

            <div class="ventajas-grid">
              <div class="ventaja-card">
                <div class="ventaja-card__title">Fabricación a medida</div>
                <div class="ventaja-card__text">Se proveen en largo y ancho según las dimensiones requeridas por el equipo zaranda. Sin restricciones de tamaño estándar.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Alta resistencia al desgaste</div>
                <div class="ventaja-card__text">Fabricadas con alambre de aleación de acero especialmente seleccionado para resistir la abrasión y el desgaste prematuro en condiciones de uso intensivo.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Con o sin borde de sujeción</div>
                <div class="ventaja-card__text">Pueden fabricarse con borde de sujeción recubierto o no de chapa, adaptándose a los distintos tipos de marcos y equipos.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Uso en diversas industrias</div>
                <div class="ventaja-card__text">Aplicables en minería, construcción, áridos, agroindustria y reciclado. Fabricadas en planta industrial propia.</div>
              </div>
            </div>

            <div class="callout" style="margin-top: 18px;">
              <div>
                <div class="callout__title">¿Necesitás una zaranda a medida?</div>
                <div class="callout__text">Indicanos largo, ancho, apertura de malla, material y si requiere borde de sujeción para recibir una cotización.</div>
              </div>
              <button class="btn btn--primary" routerLink="/contacto">Consultar</button>
            </div>
          </ng-container>

          <!-- Especificaciones discos filtrantes -->
          <ng-container *ngIf="selectedProductoKey() === 'disco'">
            <p class="lead">Contamos con un gran stock de matrices para cortes de discos para extrusión, de todos los diámetros. Fabricados en planta industrial propia. Consulte por fabricación en medidas especiales.</p>

            <div class="ventajas-grid">
              <div class="ventaja-card">
                <div class="ventaja-card__title">Stock permanente</div>
                <div class="ventaja-card__text">Amplio stock de matrices para todos los diámetros estándar, con disponibilidad inmediata para minimizar paradas de producción.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Medidas especiales</div>
                <div class="ventaja-card__text">Fabricamos discos en diámetros fuera de lo estándar según los requerimientos específicos de cada equipo o proceso.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Uso en diversas industrias</div>
                <div class="ventaja-card__text">Aplicables en extrusión de plásticos, industria alimenticia, química, petroquímica y cualquier proceso que requiera filtración por disco.</div>
              </div>
              <div class="ventaja-card">
                <div class="ventaja-card__title">Fabricación propia</div>
                <div class="ventaja-card__text">Producidos en planta industrial propia, garantizando control de calidad en cada etapa del proceso de fabricación.</div>
              </div>
            </div>

            <div class="callout" style="margin-top: 18px;">
              <div>
                <div class="callout__title">¿Necesitás un disco a medida?</div>
                <div class="callout__text">Indicanos el diámetro, material, apertura de malla y cantidad requerida para recibir una cotización.</div>
              </div>
              <button class="btn btn--primary" routerLink="/contacto">Consultar</button>
            </div>
          </ng-container>

        </section>

        <!-- TAB: USOS -->
        <section class="card__body" *ngIf="activeTab() === 'usos'">
          <div class="two-col">
            <div>
              <h3 class="h3">Aplicaciones típicas</h3>
              <ul class="checklist">
                <li *ngFor="let u of productoActual().usos">{{ u }}</li>
              </ul>

              <h3 class="h3">Qué información necesitás definir</h3>
              <ul class="bullets">
                <li>Material (AISI 304 o 316)</li>
                <li>Ancho requerido (1000 / 1220 / 1300 / 1600 mm)</li>
                <li>Número de malla y Ø de alambre</li>
              </ul>
            </div>

            <div class="mini-card">
              <div class="mini-card__title">¿Querés que lo armemos con vos?</div>
              <div class="mini-card__text">
                Escribí la consulta con tu malla y el ancho: te devolvemos una recomendación / presupuesto.
              </div>
              <button class="btn btn--primary" routerLink="/contacto">
                Pedir presupuesto
              </button>
            </div>
          </div>
        </section>
      </article>

      <!-- SIDEBAR: GALERÍA -->
      <aside class="card gallery">
        <header class="card__header">
          <div>
            <h2 class="card__title">Galería</h2>
            <p class="card__subtitle">Ejemplos de productos / aplicaciones</p>
          </div>
        </header>

        <div class="card__body">
          <div class="gallery__viewport" aria-label="Galería de imágenes con scroll automático">
            <div class="gallery__track">
              <figure class="gallery__item" *ngFor="let img of galleryImages">
                <img class="gallery__img" [src]="img.src" [alt]="img.alt" loading="lazy" />
                <figcaption class="gallery__caption">{{ img.title }}</figcaption>
              </figure>

              <figure class="gallery__item" *ngFor="let img of galleryImages">
                <img class="gallery__img" [src]="img.src" [alt]="img.alt" loading="lazy" />
                <figcaption class="gallery__caption">{{ img.title }}</figcaption>
              </figure>
            </div>
          </div>

          <p class="gallery__hint">Tip: al pasar el mouse, el scroll se pausa.</p>
        </div>
      </aside>
    </div>
  </section>

  <!-- BANDA FINAL -->
  <section class="band">
    <div class="container band__grid">
      <div>
        <h2 class="band__title">¿Necesitás asesoramiento?</h2>
        <p class="band__text">Te ayudamos a seleccionar la malla ideal según el trabajo a realizar.</p>
      </div>
      <div class="band__actions">
        <button class="btn btn--ghostOnDark" (click)="setTab('descripcion')">Volver a descripción</button>
        <button class="btn btn--primaryOnDark" (click)="setTab('especificaciones')">Ver tabla</button>
      </div>
    </div>
  </section>
</main>
